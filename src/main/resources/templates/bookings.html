<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Мои брони</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div th:replace="~{fragments/header :: header}"></div>

<div class="container mt-4">
    <h2 class="mb-4">
        <span th:if="${isAdminOrWorker}">Все бронирования</span>
        <span th:unless="${isAdminOrWorker}">Мои брони</span>
    </h2>

    <!-- Брони событий -->
    <h4 class="text-primary mb-3">Билеты на мероприятия</h4>
    <div class="table-responsive mb-5">
        <table class="table table-striped table-hover">
            <thead class="table-primary">
            <tr>
                <th>ID</th>
                <th>Мероприятие</th>
                <th>Дата и время</th>
                <th>Цена</th>
                <th>Статус</th>
                <th th:if="${isAdminOrWorker}">Действия</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="b : ${eventBookings}">
                <td th:text="${b.id}"></td>
                <td th:text="${b.event.title}"></td>
                <td th:text="${#temporals.format(b.event.startTime, 'dd.MM.yyyy HH:mm')}"></td>
                <td th:text="${b.price} + ' ₽'"></td>
                <td>
                    <span class="badge bg-success" th:text="${b.status}"></span>
                </td>
                <td th:if="${isAdminOrWorker}">
                    <button class="btn btn-sm btn-warning">Изменить</button>
                    <button class="btn btn-sm btn-danger">Отменить</button>
                </td>
            </tr>
            <tr th:unless="${eventBookings}">
                <td colspan="6" class="text-center text-muted">Нет забронированных мероприятий</td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- Брони залов -->
    <h4 class="text-success mb-3">Бронирование залов</h4>
    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead class="table-success">
            <tr>
                <th>ID</th>
                <th>Зал</th>
                <th>Слот</th>
                <th>Время</th>
                <th>Кол-во человек</th>
                <th>Цена</th>
                <th>Статус</th>
                <th th:if="${isAdminOrWorker}">Действия</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="b : ${roomBookings}">
                <td th:text="${b.id}"></td>
                <td th:text="${b.room.name}"></td>
                <td th:text="${b.slotNumber}"></td>
                <td th:text="${#temporals.format(b.startTime, 'dd.MM HH:mm')} + ' – ' + ${#temporals.format(b.endTime, 'HH:mm')}"></td>
                <td th:text="${b.bookingWeight}"></td>
                <td th:text="${b.price} + ' ₽'"></td>
                <td>
                        <span class="badge"
                              th:class="${b.status == 'подтверждено' ? 'bg-success' : 'bg-warning'}"
                              th:text="${b.status}"></span>
                </td>
                <td th:if="${isAdminOrWorker}">
                    <button class="btn btn-sm btn-warning">Изменить</button>
                    <button class="btn btn-sm btn-danger">Отменить</button>
                </td>
            </tr>
            <tr th:unless="${roomBookings}">
                <td colspan="8" class="text-center text-muted">Нет забронированных залов</td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
</body>
</html>